hist(BC.device)
hist(BRANDS_NY[,9])
hist(BRANDS_NY[,10])
View(BRANDS_NY)
hist(BRANDS_NY[,5])
hist(BC.median)
boxplot(BC.median)
hist(BC.device)
boxplot(BC.device)
hist(BC.dist_primary)
boxplot(BC.dist_primary)
hist(BC.lunch)
boxplot(BC.lunch)
boxplot(BC.lunch)
mod=lm(freq ~ BC.dist_home +BC.dist_primary + BC.stop
+ BC.median + BC.break + BC.lunch + BC.aft+ BC.dinner + BC.night)
model <- lm(freq ~ raw_device_counts + distance_from_home +
median_dwell +
sum_lunch + sum_night)
summary(model) # Adjusted R-squared:  0.2674  sta peggiorando ...
shapiro.test(model$residuals) #0.00104 migliorato
lambda_multivariate <- powerTransform(cbind(freq, raw_device_counts,median_dwell,
distance_from_home,
(sum_lunch+1e-16), (sum_afternoon+1e-16),
(sum_night+1e-16)))
lambda_multivariate
BC.freq <- bcPower(median_dwell, lambda_multivariate$lambda[1])
BC.device <- bcPower(raw_device_counts, lambda_multivariate$lambda[2])
BC.median <- bcPower(median_dwell, lambda_multivariate$lambda[3])
BC.dist_home <- bcPower(distance_from_home, lambda_multivariate$lambda[4])
BC.lunch <- bcPower(sum_lunch+1e-16, lambda_multivariate$lambda[5])
BC.aft <- bcPower(sum_afternoon+1e-16, lambda_multivariate$lambda[6])
BC.night <- bcPower(sum_night+1e-16, lambda_multivariate$lambda[7])
mod=lm(BC.freq ~ BC.device + BC.dist_home
+ BC.median + BC.lunch + BC.aft + BC.night)
summary(mod) #Adjusted R-squared:  0.9673 ma pvalue peggiorati ...
shapiro.test(mod$residuals)
mod=lm(freq ~ BC.device + BC.dist_home
+ BC.median + BC.lunch + BC.aft + BC.night)
summary(mod) #Adjusted R-squared:  0.9673 ma pvalue peggiorati ...
shapiro.test(mod$residuals) #pessimo
#eliminate the most collinear regressors
x11()
plot(BC.stop, BC.device)
plot(BC.stop, BC.dist_home) #
plot(BC.dist_home, BC.dist_primary) #
plot(BC.stop, BC.median) #
#
# mod=lm(BC.freq ~ BC.stop + BC.device + BC.dist_home +BC.dist_primary
#        + BC.median + BC.break + BC.lunch + BC.aft+ BC.dinner + BC.night)
# summary(mod) #Adjusted R-squared:  0.3043
# shapiro.test(mod$residuals) # 4.971e-07 peggiora ... why?!!
# x11()
# par(mfrow=c(2,2))
# plot(mod) #non bellissimo
################################################################################
#torno al modello senza freq trasformata ma boh
vif(mod)
plot(BC.stop, BC.aft) #
#eliminate the most collinear regressors
x11()
plot(BC.stop, BC.aft) #
plot(BC.stop, BC.lunch) #
#eliminate the most collinear regressors
x11()
plot(BC.stop, BC.lunch) #
#eliminate the most collinear regressors
x11()
plot(BC.stop, BC.break) #
plot(BC.stop, BC.night)
plot(BC.stop, BC.dinner)
#eliminate the most collinear regressors
x11()
plot(BC.stop, BC.dinner)
setwd("/home/terri/Documenti/UNIVERSITA/STAT APP/progetto/gitcode/Applied-statistics-project/ANALISI FUNZIONALE STOPS")
load("/home/terri/Documenti/UNIVERSITA/STAT APP/progetto/gitcode/Applied-statistics-project/DATASET/NYC_no_river.RData")
load("/home/terri/Documenti/UNIVERSITA/STAT APP/progetto/gitcode/Applied-statistics-project/DATASET/CBG_NY_no_river.RData")
load("/home/terri/Documenti/UNIVERSITA/STAT APP/progetto/gitcode/Applied-statistics-project/DATASET/River_Dataset.RData")
New_York_County_no_river= New_York_County_no_river[order( New_York_County_no_river$area),]
CBG_ny_no_river<-CBG_ny_no_river[order( CBG_ny_no_river$CensusBlockGroup),]
attach( New_York_County_no_river)
detach(BRANDS_NY)
detach(BRANDS_NY)
detach(BRANDS_NY)
detach(BRANDS_NY)
detach(New_York_County_no_river)
detach(New_York_County_no_river)
attach( New_York_County_no_river)
View(New_York_County_no_river)
stops<-matrix(nrow = 1092, ncol=30*24)
for (i in 1:dim( New_York_County_no_river)[1]) {
stops[i,]<-stops_by_each_hour[[i]]
}
detach( New_York_County_no_river)
stops<-stops[,505:672]
stops<-t(stops)
colnames(stops)<- New_York_County_no_river$area
x11()
matplot(stops,type='l', main = "22/06 - 28/06")
# outliers
out=c(92,532)
cbg_out=New_York_County_no_river[out,1]
layout(1)
x11()
matplot(stops,type='l')
lines(stops[,92],lwd=4, col=2)
lines(stops[,532],lwd=4, col=1)
out1 <- New_York_County_no_river[out[1],]
out2 <- New_York_County_no_river[out[2],]
View(New_York_County_no_river)
View(stops)
matplot(out1$popularity_by_hour_monday,type='l')
out1$popularity_by_hour_monday
x11()
matplot(t(out1$popularity_by_hour_monday),type='l')
help("matplot")
days <- rbind(out1$popularity_by_hour_monday, out1$popularity_by_hour_tuesday)
View(days)
dim(out1$popularity_by_hour_monday)
length(out1$popularity_by_hour_monday)
length(out1$stops_by_each_hour)
length(out1$stops_by_each_hour[[]])
length(out1$stops_by_each_hour[[,1]])
length(out1$stops_by_each_hour[[1]])
length(out1$popularity_by_hour_monday[[1]])
days<-matrix(nrow = 7, ncol=24)
i<-1
out1$popularity_by_hour_monday[[i]]
out1$popularity_by_hour_monday[[i,i]]
days[i,]<-out1$popularity_by_hour_monday[[i]]
View(days)
days<-matrix(nrow = 7, ncol=24)
for (i in 1:24) {
days[i,]<-out1$popularity_by_hour_monday[[i]]
}
days<-matrix(nrow = 7, ncol=24)
for (i in 1:7) {
days[i,]<-out1$popularity_by_hour_monday[[i]]
}
days<-matrix(nrow = 7, ncol=24)
days[1,]<-out1$popularity_by_hour_monday[[1]]
days[2,]<-out1$popularity_by_hour_tuesday[[1]]
days[3,]<-out1$popularity_by_hour_wednesday[[1]]
days[4,]<-out1$popularity_by_hour_thursday[[1]]
days[5,]<-out1$popularity_by_hour_friday[[1]]
days[6,]<-out1$popularity_by_hour_saturday[[1]]
days[7,]<-out1$popularity_by_hour_sunday[[1]]
x11()
matplot(days,type='l')
days<-t(days)
x11()
matplot(days,type='l')
my_col <- rainbow(7)
x11()
matplot(days,type='l', col = my_col)
out1$stops_by_each_hour
seq(1,30,7)
seq(1,168,24)
seq(23,168,24)
seq(1,168,23) : seq(23,168,24)
seq(1,168,23)
seq(24,168,23)
seq(23,168,23)
seq(1,168,24)
seq(1,168,24*7)
120/5
dim(out1$stops_by_each_hour)
dim(out1$stops_by_each_hour[[1]])
length(out1$stops_by_each_hour[[1]])
seq(1,720,24*7)
seq(23,720,24*7)
seq(1,720,24*7-1)
seq(23,720,24*7-1)
i<-1
inizio <- seq(1,720,24*7-1)[i]
fine <- seq(23,720,24*7-1)[i]
lun[i] <- out1$stops_by_each_hour[[inizio_fine]]
lun[i] <- out1$stops_by_each_hour[[inizio:fine]]
lun[i] <- out1$stops_by_each_hour[[1]][inizio:fine]
lun <- matrix(nrow = 5, ncol=24)
lun[i] <- out1$stops_by_each_hour[[1]][inizio:fine]
out1$stops_by_each_hour[[1]][inizio:fine]
fine <- seq(24,720,24*7-1)[i]
lun[i] <- out1$stops_by_each_hour[[1]][inizio:fine]
out1$stops_by_each_hour[[1]][inizio:fine]
stops[,92]
lun <- matrix(nrow = 5, ncol=24)
inizio <- seq(1,720,24*7-1)[i]
fine <- seq(24,720,24*7-1)[i]
lun[i] <- out1$stops_by_each_hour[[1]][inizio:fine]
lun[i]
lun[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
lun[i,]
lun <- matrix(nrow = 5, ncol=24)
for (i in 1:5){
inizio <- seq(1,720,24*7-1)[i]
fine <- seq(24,720,24*7-1)[i]
lun[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
lun
lun[4]
lun[4,]
stops[,92]
legend()
legend(col =my_col)
matplot(days,type='l', col = my_col, legend = levels(my_col)) #7 giorni settimanali, già fatta la media dentro popularity ...
x11()
matplot(days,type='l', col = my_col, legend = levels(my_col)) #7 giorni settimanali, già fatta la media dentro popularity ...
legend("bottomright", col =my_col)
legend("bottomright", legend =my_col)
legend("bottomright", legend= days col = my_col)
legend("bottomright", legend= days, col = my_col)
x11()
matplot(days,type='l', col = my_col) #7 giorni settimanali, già fatta la media dentro popularity ...
legend("topleft", legend= days, col = my_col)
x11()
matplot(days,type='l', col = my_col) #7 giorni settimanali, già fatta la media dentro popularity ...
legend("topleft", legend= c('mon', 'tue','wed', 'thu', 'fri', 'sat', 'sun'), col = my_col)
x11()
matplot(days,type='l', col = my_col) #7 giorni settimanali, già fatta la media dentro popularity ...
legend("topleft", legend= c('mon', 'tue','wed', 'thu', 'fri', 'sat', 'sun'), fill = my_col)
x11()
matplot(days[1,],type='l', col = my_col) #7 giorni settimanali, già fatta la media dentro popularity ...
legend("topleft", legend= c('mon', 'tue','wed', 'thu', 'fri', 'sat', 'sun'), fill = my_col)
x11()
matplot(days[1,],type='l', col = my_col) #7 giorni settimanali, già fatta la media dentro popularity ...
legend("topleft", legend= c('mon', 'tue','wed', 'thu', 'fri', 'sat', 'sun'), fill = my_col)
x11()
matplot(days[,1],type='l', col = my_col) #7 giorni settimanali, già fatta la media dentro popularity ...
legend("topleft", legend= c('mon', 'tue','wed', 'thu', 'fri', 'sat', 'sun'), fill = my_col)
seq(1,720,24*7-1)
seq(24,720,24*7-1)
lun[4,]
stops[,92]
lun <- matrix(nrow = 5, ncol=24)
for (i in 1:5){
inizio <- seq(1,720,24*7)[i]
fine <- seq(24,720,24*7)[i]
lun[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
lun[4,]
seq(1,720,24*7)
seq(24,720,24*7)
mar <- matrix(nrow = 4, ncol=24)
for (i in 1:4){
inizio <- seq(1,720,24*7)[i]
fine <- seq(24,720,24*7)[i]
mar[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
lun <- matrix(nrow = 5, ncol=24)
for (i in 1:5){
inizio <- seq(1,720,24*7)[i]
fine <- seq(24,720,24*7)[i]
lun[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
lun[4,]
mar <- matrix(nrow = 4, ncol=24)
for (i in 1:4){
inizio <- seq(1,720,24*7)[i]
fine <- seq(24,720,24*7)[i]
mar[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
mer <- matrix(nrow = 4, ncol=24)
for (i in 1:5){
inizio <- seq(1,720,24*7)[i]
fine <- seq(24,720,24*7)[i]
mer[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
gio <- matrix(nrow = 4, ncol=24)
for (i in 1:4){
inizio <- seq(1,720,24*7)[i]
fine <- seq(24,720,24*7)[i]
gio[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
ven <- matrix(nrow = 4, ncol=24)
for (i in 1:5){
inizio <- seq(1,720,24*7)[i]
fine <- seq(24,720,24*7)[i]
ven[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
sab <- matrix(nrow = 4, ncol=24)
for (i in 1:4){
inizio <- seq(1,720,24*7)[i]
fine <- seq(24,720,24*7)[i]
sab[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
dom <- matrix(nrow = 4, ncol=24)
for (i in 1:4){
inizio <- seq(1,720,24*7)[i]
fine <- seq(24,720,24*7)[i]
dom[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
lun <- t(lun)
mar <- t(mar)
mer <- t(mer)
gio <- t(gio)
ven <- t(ven)
sab <- t(sab)
dom <- t(dom)
x11()
matplot(lun,type='l')
library(RColorBrewer)
YiOrRd(7)
YIOrRd(7)
brewer.pal(n = 7, name = "YIOrRd")
display.brewer.pal(n = 7, name = "YIOrRd")
display.brewer.pal(n = 7, name = YIOrRd)
col = display.brewer.pal(n = 7, name = 'YIOrRd')
col = display.brewer.pal(n = 7, name = 'Set2')
col = display.brewer.pal(n = 7, name = 'YlOrRd')
x11()
matplot(lun,type='l', col = col)
col = display.brewer.pal(n = 5, name = 'YlOrRd')
x11()
matplot(lun,type='l', col = col)
col = brewer.pal(n = 5, name = 'YlOrRd')
x11()
matplot(lun,type='l', col = col)
col = brewer.pal(n = 5, name = 'Dark2')
x11()
matplot(lun,type='l', col = col)
col = brewer.pal(n = 4, name = 'YlGnBu')
x11()
matplot(mar,type='l', col = col)
x11()
matplot(mar,type='l', col = col, lwd =4)
x11()
matplot(lun,type='l', col = col[2:7])
col = brewer.pal(n = 7, name = 'YlOrRd')
x11()
matplot(lun,type='l', col = col[2:7])
col = brewer.pal(n = 8, name = 'YlOrRd')
x11()
matplot(lun,type='l', col = col[3:8])
col = brewer.pal(n = 8, name = 'YlGnBu')
col = brewer.pal(n = 8, name = 'YlGnBu')
x11()
matplot(mar,type='l', col = col[4:8])
col = brewer.pal(n = 8, name = 'YlGn')
x11()
matplot(mar,type='l', col = col[4:8])
matplot(mar,type='l', col = col[4:8], lwd=2)
col = brewer.pal(n = 8, name = 'RdPu')
x11()
col = brewer.pal(n = 8, name = 'YlGn')
x11()
matplot(mer,type='l', col = col[4:8], lwd=2)
inizio <- seq(1,720,24*7)[i] + 24
i<-1
inizio <- seq(1,720,24*7)[i] + 24
inizio <- seq(25,720,24*7)[i]
fine <- seq(48,720,24*7)[i]
seq(25,720,24*7)
seq(48,720,24*7)
24*3
seq(49,720,24*7)
seq(72,720,24*7)
seq(50,720,24*7)
seq(73,720,24*7)
24*4
24*5
seq(97,720,24*7)
seq(120,720,24*7)
24*6
seq(121,720,24*7)
seq(144,720,24*7)
inizio <- seq(1,720,24*7)
seq(1,720,24*7)
lun <- matrix(nrow = 5, ncol=24)
for (i in 1:5){
inizio <- seq(1,720,24*7)[i]
fine <- seq(24,720,24*7)[i]
lun[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
lun[4,]
mar <- matrix(nrow = 4, ncol=24)
for (i in 1:4){
inizio <- seq(25,720,24*7)[i]
fine <- seq(48,720,24*7)[i]
mar[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
mer <- matrix(nrow = 4, ncol=24)
for (i in 1:5){
inizio <- seq(49,720,24*7)[i]
fine <- seq(72,720,24*7)[i]
mer[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
gio <- matrix(nrow = 4, ncol=24)
for (i in 1:4){
inizio <- seq(50,720,24*7)[i]
fine <- seq(73,720,24*7)[i]
gio[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
ven <- matrix(nrow = 4, ncol=24)
for (i in 1:5){
inizio <- seq(74,720,24*7)[i]
fine <- seq(96,720,24*7)[i]
ven[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
sab <- matrix(nrow = 4, ncol=24)
for (i in 1:4){
inizio <- seq(97,720,24*7)[i]
fine <- seq(120,720,24*7)[i]
sab[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
dom <- matrix(nrow = 4, ncol=24)
for (i in 1:4){
inizio <- seq(121,720,24*7)[i]
fine <- seq(144,720,24*7)[i]
dom[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
col = brewer.pal(n = 8, name = 'YlGn')
x11()
matplot(mer,type='l', col = col[4:8], lwd=2)
lun <- t(lun)
mar <- t(mar)
mer <- t(mer)
gio <- t(gio)
ven <- t(ven)
sab <- t(sab)
dom <- t(dom)
x11()
matplot(mer,type='l', col = col[4:8], lwd=2)
seq(1,720,24*7)
seq(24,720,24*7)
seq(25,720,24*7)
seq(48,720,24*7)
seq(49,720,24*7)
seq(72,720,24*7)
seq(50,720,24*7)
seq(73,720,24*7)
24*4
24*7
24*6
dom <- matrix(nrow = 4, ncol=24)
for (i in 1:4){
inizio <- seq(145,720,24*7)[i]
fine <- seq(168,720,24*7)[i]
dom[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
lun <- matrix(nrow = 5, ncol=24)
for (i in 1:5){
inizio <- seq(1,720,24*7)[i]
fine <- seq(24,720,24*7)[i]
lun[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
lun[4,]
mar <- matrix(nrow = 4, ncol=24)
for (i in 1:4){
inizio <- seq(25,720,24*7)[i]
fine <- seq(48,720,24*7)[i]
mar[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
mer <- matrix(nrow = 4, ncol=24)
for (i in 1:5){
inizio <- seq(49,720,24*7)[i]
fine <- seq(72,720,24*7)[i]
mer[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
gio <- matrix(nrow = 4, ncol=24)
for (i in 1:4){
inizio <- seq(73,720,24*7)[i]
fine <- seq(96,720,24*7)[i]
gio[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
ven <- matrix(nrow = 4, ncol=24)
for (i in 1:5){
inizio <- seq(97,720,24*7)[i]
fine <- seq(120,720,24*7)[i]
ven[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
sab <- matrix(nrow = 4, ncol=24)
for (i in 1:4){
inizio <- seq(121,720,24*7)[i]
fine <- seq(144,720,24*7)[i]
sab[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
dom <- matrix(nrow = 4, ncol=24)
for (i in 1:4){
inizio <- seq(145,720,24*7)[i]
fine <- seq(168,720,24*7)[i]
dom[i,] <- out1$stops_by_each_hour[[1]][inizio:fine]
}
lun <- t(lun)
mar <- t(mar)
mer <- t(mer)
gio <- t(gio)
ven <- t(ven)
sab <- t(sab)
dom <- t(dom)
col = brewer.pal(n = 8, name = 'YlOrRd')
x11()
matplot(lun,type='l', col = col[3:8], lwd =2)
col = brewer.pal(n = 8, name = 'YlGnBu')
x11()
matplot(mar,type='l', col = col[4:8],  lwd =2)
col = brewer.pal(n = 8, name = 'YlGn')
x11()
matplot(mer,type='l', col = col[4:8], lwd=2)
col = brewer.pal(n = 8, name = 'RdPu')
x11()
matplot(mar,type='l', col = col[4:8], lwd=2)
matplot(gio,type='l', col = col[4:8], lwd=2)
col = brewer.pal(n = 8, name = 'OrRd')
x11()
matplot(ven,type='l', col = col[4:8], lwd=2)
col = brewer.pal(n = 8, name = 'Greens')
x11()
matplot(sab,type='l', col = col[4:8], lwd=2)
col = brewer.pal(n = 8, name = 'Blues')
x11()
matplot(dom,type='l', col = col[4:8], lwd=2)
