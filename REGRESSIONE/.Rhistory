BC.device <- bcPower(raw_device_counts, 0)
BC.home <- bcPower(distance_from_home, lambda_multivariate$lambda[3])
BC.primary <- bcPower(distance_from_primary_daytime_location, lambda_multivariate$lambda[4])
BC.median <- bcPower(median_dwell, lambda_multivariate$lambda[5])
x11()
plot(BC.stop, median_dwell)
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_ny$geometry[index_cbg_stop]), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
library(sf)
library(geosphere)
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_ny$geometry[index_cbg_stop]), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
library(sp)           ## Data management
library(lattice)      ## Data management
library(geoR)         ## Geostatistics
install.packages(geoR)
install.packages("geoR")
library(gstat)        ## Geostatistics
install.packages("gstat")
library(geoR)         ## Geostatistics
library(gstat)
data(meuse)
head(meuse)
## Define the sample coordinates
coordinates(meuse) <- c('x','y') #SET COORDINATES
head(meuse)
# bubble plot(obj,zcol,...)
# key.space=location of the key
bubble(meuse,'zinc',do.log=TRUE,key.space='bottom')
# river meuse
data(meuse.riv)
meuse.lst <- list(Polygons(list(Polygon(meuse.riv)), "meuse.riv"))
meuse.sr <- SpatialPolygons(meuse.lst)
# grid for prediction
data(meuse.grid)
is(meuse.grid)
coordinates(meuse.grid) <- c('x','y')
meuse.grid <- as(meuse.grid, 'SpatialPixelsDataFrame')
# plot all together
image(meuse.grid, col = "lightgrey")
plot(meuse.sr, col = "grey", add = TRUE)
plot(meuse, add = TRUE)
title('meuse river geostatistical data')
meuse.riv
# histogram of zinc variable
hist(meuse$zinc, breaks=16, col="grey", main='Histogram of Zn', prob = TRUE, xlab = 'Zn') #asymmetric data
# highly skewed, transform to the log
hist(log(meuse$zinc), breaks=16, col="grey", main='Histogram of log(Zn)', prob = TRUE, xlab = 'log(Zn)')
# scatterplot of log(zinc) with respect to distance from the river
xyplot(log(zinc) ~ sqrt(dist), as.data.frame(meuse))
# Negative correlation: lower distance from the river => higher level of zinc
dev.off()
load("C:/Users/franc/Desktop/PoliMI/Anno Accademico 2020-2021/Applied Statistics/Progetto/Applied-statistics-project/DATASET/Data frame county/New York County.RData") # FRA
loa
load("C:/Users/franc/Desktop/PoliMI/Anno Accademico 2020-2021/Applied Statistics/Progetto/Applied-statistics-project/DATASET/Data frame county/New York County.RData") # FRA
load("C:/Users/franc/Desktop/PoliMI/Anno Accademico 2020-2021/Applied Statistics/Progetto/Applied-statistics-project/DATASET/Conversione dal dataset originale ad adesso/Cyber_Capital.RData")
# terri
library(car)
library(geosphere)
library(sf)
New_York_County=New_York_County[order(New_York_County$area),]
CBG_ny_index = which(census_blocks_ny$County=="New York County")
CBG_ny = census_blocks_ny[CBG_ny_index,]
# make the two datasets equal
remove=c()
k=1
for (i in 1:1170) {
index=which(New_York_County$area==CBG_ny$CensusBlockGroup[i])
if (length(index)==0) {
remove[k]=i
k=k+1
}
}
CBG_ny=CBG_ny[-remove,]
CBG_ny=CBG_ny[order(CBG_ny$CensusBlockGroup),]
CBG_ny_index=CBG_ny_index[-remove]
attach(New_York_County)
lambda_multivariate <- powerTransform(cbind(New_York_County$raw_stop_counts, New_York_County$raw_device_counts,New_York_County$distance_from_home,New_York_County$distance_from_primary_daytime_location,New_York_County$median_dwell))
lambda_multivariate
# powerTransform(ais$LBM), is equivalent to powerTransform(LBM ~ 1, ais)
lambda_multivariate <- powerTransform(cbind(New_York_County$raw_stop_counts, New_York_County$raw_device_counts,New_York_County$distance_from_home,New_York_County$distance_from_primary_daytime_location)~New_York_County$median_dwell)
lambda_multivariate
BC.stop <- bcPower(raw_stop_counts, 0)
BC.device <- bcPower(raw_device_counts, 0)
BC.home <- bcPower(distance_from_home, lambda_multivariate$lambda[3])
BC.primary <- bcPower(distance_from_primary_daytime_location, lambda_multivariate$lambda[4])
BC.median <- bcPower(median_dwell, lambda_multivariate$lambda[5])
LM_2 <- data.frame(BC.stop,BC.device ,BC.home,BC.primary,median_dwell )
index_stop<-which(BC.stop<=6.5)
area_stop<-New_York_County$area[index_stop]
index_cbg_stop<-c()
for (i in 1:length(area_stop))
index_cbg_stop[i] <- which(area_stop[i]==CBG_ny$CensusBlockGroup)
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_ny$geometry[index_cbg_stop]), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
#doobiamo capire che farne:
index_stop<-which(BC.stop<=6.6)
area_stop<-New_York_County$area[index_stop]
index_cbg_stop<-c()
for (i in 1:length(area_stop))
index_cbg_stop[i] <- which(area_stop[i]==CBG_ny$CensusBlockGroup)
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_ny$geometry[index_cbg_stop]), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
index_stop<-which(BC.stop<=6.7)
area_stop<-New_York_County$area[index_stop]
index_cbg_stop<-c()
for (i in 1:length(area_stop))
index_cbg_stop[i] <- which(area_stop[i]==CBG_ny$CensusBlockGroup)
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_ny$geometry[index_cbg_stop]), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
index_stop<-which(BC.stop<=6.8)
area_stop<-New_York_County$area[index_stop]
index_cbg_stop<-c()
for (i in 1:length(area_stop))
index_cbg_stop[i] <- which(area_stop[i]==CBG_ny$CensusBlockGroup)
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_ny$geometry[index_cbg_stop]), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
index_stop<-which(BC.stop<=6.9)
area_stop<-New_York_County$area[index_stop]
index_cbg_stop<-c()
for (i in 1:length(area_stop))
index_cbg_stop[i] <- which(area_stop[i]==CBG_ny$CensusBlockGroup)
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_ny$geometry[index_cbg_stop]), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
index_stop<-which(BC.stop<=7)
area_stop<-New_York_County$area[index_stop]
index_cbg_stop<-c()
for (i in 1:length(area_stop))
index_cbg_stop[i] <- which(area_stop[i]==CBG_ny$CensusBlockGroup)
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_ny$geometry[index_cbg_stop]), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
index_stop<-which(BC.stop<=7.1)
area_stop<-New_York_County$area[index_stop]
index_cbg_stop<-c()
for (i in 1:length(area_stop))
index_cbg_stop[i] <- which(area_stop[i]==CBG_ny$CensusBlockGroup)
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_ny$geometry[index_cbg_stop]), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
index_stop<-which(BC.stop<=6.9)
area_stop<-New_York_County$area[index_stop]
index_cbg_stop<-c()
for (i in 1:length(area_stop))
index_cbg_stop[i] <- which(area_stop[i]==CBG_ny$CensusBlockGroup)
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_ny$geometry[index_cbg_stop]), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
index_stop<-which(BC.stop<=6.8)
area_stop<-New_York_County$area[index_stop]
index_cbg_stop<-c()
for (i in 1:length(area_stop))
index_cbg_stop[i] <- which(area_stop[i]==CBG_ny$CensusBlockGroup)
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_ny$geometry[index_cbg_stop]), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
index_stop<-which(BC.stop<=6.7)
area_stop<-New_York_County$area[index_stop]
index_cbg_stop<-c()
for (i in 1:length(area_stop))
index_cbg_stop[i] <- which(area_stop[i]==CBG_ny$CensusBlockGroup)
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_ny$geometry[index_cbg_stop]), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
index_stop<-which(BC.stop<=6.8)
area_stop<-New_York_County$area[index_stop]
index_cbg_stop<-c()
for (i in 1:length(area_stop))
index_cbg_stop[i] <- which(area_stop[i]==CBG_ny$CensusBlockGroup)
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_ny$geometry[index_cbg_stop]), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
index_stop<-which(BC.stop<=6.7)
area_stop<-New_York_County$area[index_stop]
index_cbg_stop<-c()
for (i in 1:length(area_stop))
index_cbg_stop[i] <- which(area_stop[i]==CBG_ny$CensusBlockGroup)
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_ny$geometry[index_cbg_stop]), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
CBG_RIVER<-CBG_ny[index_cbg_stop,]
View(CBG_RIVER)
View(CBG_RIVER)
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_ny$geometry[index_cbg_stop]), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
CBG_ny$CensusBlockGroup[index_cbg_stop]
View(CBG_RIVER)
a<- which(CBG_RIVER$TractCode<"010601")
CBG_RIVER[a,]
CBG_RIVER <- CBG_RIVER[a,]
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_RIVER$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
index_stop<-which(BC.stop<=6.7)
area_stop<-New_York_County$area[index_stop]
index_cbg_stop<-c()
for (i in 1:length(area_stop))
index_cbg_stop[i] <- which(area_stop[i]==CBG_ny$CensusBlockGroup)
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_ny$geometry[index_cbg_stop]), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
View(CBG_ny)
View(CBG_RIVER)
# TROVIAMO I CBG DEI FIUMI
CBG_RIVER<-CBG_ny[index_cbg_stop,]
View(CBG_RIVER)
View(CBG_RIVER)
track_code_river <- c("027500", "025500", "024700", "024100", "023700", "023300", "022900", "022500", "022301", "021900","021100","020500", "019900", "019500",
"019100", "018700", "018300", "017900", "017500", "017100","016700", "016300", "015900", "015100", "013500", "012900", "011700", "009900", "007900", "007500", "006900", "003700",
"003900", "031703", "031704","031900", "000500", "000900","000700", "001502", "001501", "002500", "000800","000600","000201", "000202", "001001", "001002", "002000", "002400", "004400",
"006000", "006200", "008601", "008602", "023801", "010601","010602","011600", "012400", "013200", "013600", "023802", "015200","017800", "019200", "024200", "021000", "023600", "024302", "031100",
"029900", "029700", "028700")
index_river = which(CBG_ny$TractCode == track_code_river)
index_river=c()
for (i in CBG_ny) {
index_river[i] = which(CBG_ny$TractCode[i] == track_code_river)
}
CBG_ny$TractCode[1]
index_river=c()
for (i in CBG_ny) {
index_river[i] = which(track_code_river==CBG_ny$TractCode[i])
}
which(track_code_river == "000100")
index_river=list()
for (i in CBG_ny) {
index_river[i] = which(track_code_river==CBG_ny$TractCode[i])
}
index_river=list()
for (i in CBG_ny) {
append(index_river,which(track_code_river==CBG_ny$TractCode[i]))
}
index_river=list()
for (i in 1:length(CBG_ny)) {
index_river[i] = which(track_code_river==CBG_ny$TractCode[i])
}
index_river=c()
k=1
for (i in 1:length(CBG_ny)) {
if (track_code_river==CBG_ny$TractCode[i]) {
index_river[k] = i
k=k+1
}
}
index_river=c()
k=1
for (i in 1:length(CBG_ny)) {
if (CBG_ny$TractCode[i] %in% track_code_river) {
index_river[k] = i
k=k+1
}
}
View(CBG_RIVER)
index_river=c()
k=1
for (i in 1:length(CBG_ny)) {
if (CBG_ny$TractCode[i] %in% track_code_river) {
print(i)
index_river[k] = i
k=k+1
}
}
length(CBG_ny
)
index_river=c()
k=1
for (i in 1:dim(CBG_ny)[1]) {
if (CBG_ny$TractCode[i] %in% track_code_river) {
print(i)
index_river[k] = i
k=k+1
}
}
CBG_RIVER<-CBG_ny[index_river,]
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_RIVER$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
track_code_river <- c("027500", "025500", "024700", "024100", "023700", "023300", "022900", "022500", "022301", "021900","021100","020500", "019900", "019500",
"019100", "018700", "018300", "017900", "017500", "017100","016700", "016300", "015900", "015500", "015100", "013500", "012900", "011700", "009900", "007900", "007500", "006900", "003700",
"003900", "031703", "031704","031900", "000500", "000900","000700", "001502", "001501", "002500", "000800","000600","000201", "000202", "001001", "001002", "002000", "002400", "004400",
"006000", "006200", "008601", "008602", "023801", "010601","010602","011600", "012400", "013200", "013600", "023802", "015200","017800", "019200", "024200", "021000", "023600", "024302", "031100",
"029900", "029700", "028700")
index_river=c()
k=1
for (i in 1:dim(CBG_ny)[1]) {
if (CBG_ny$TractCode[i] %in% track_code_river) {
index_river[k] = i
k=k+1
}
}
# TROVIAMO I CBG DEI FIUMI
CBG_RIVER<-CBG_ny[index_river,]
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_RIVER$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
track_code_river <- c("027500", "025500", "024700", "024100", "023700", "023300", "022900", "022500", "022301", "021900","021100","020500", "019900", "019500",
"019100", "018700", "018300", "017900", "017500", "017100","016700", "016300", "015900", "015500", "015100", "013500", "012900", "011700", "009900", "007900", "007500", "006900", "003700",
"003900", "031703", "031704","031900", "000500", "000900","000700", "001502", "001501", "002500", "000800","000600","000201", "000202", "001001", "001002", "002000", "002400", "004400",
"006000", "006200", "008601", "008602", "023801", "010601","010602","011600", "012400", "013200", "013600", "023802", "015200","017800", "019200", "024200", "021000", "023600", "024302", "031100",
"029900", "029700", "028700", "022302")
index_river=c()
k=1
for (i in 1:dim(CBG_ny)[1]) {
if (CBG_ny$TractCode[i] %in% track_code_river) {
index_river[k] = i
k=k+1
}
}
# TROVIAMO I CBG DEI FIUMI
CBG_RIVER<-CBG_ny[index_river,]
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_RIVER$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
track_code_river <- c("027500", "025500", "024700", "024100", "023700", "023300", "022900", "022500", "022301", "021900","021100","020500", "019900", "019500",
"019100", "018700", "018300", "017900", "017500", "017100","016700", "016300", "015900", "015500", "015100", "013500", "012900", "011700", "009900", "007900", "007500", "006900", "003700",
"003900", "031703", "031704","031900", "000500", "000900","000700", "001502", "001501", "002500", "000800","000600","000201", "000202", "001001", "001002", "002000", "002400", "004400",
"006000", "006200", "008601", "008602", "023801", "010601","010602","011600", "012400", "013200", "013600", "023802", "015200","017800", "019200", "024200", "021000", "023600", "024302", "031100",
"029900", "029700", "028700", "022302", "016200")
index_river=c()
k=1
for (i in 1:dim(CBG_ny)[1]) {
if (CBG_ny$TractCode[i] %in% track_code_river) {
index_river[k] = i
k=k+1
}
}
# TROVIAMO I CBG DEI FIUMI
CBG_RIVER<-CBG_ny[index_river,]
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_RIVER$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
track_code_river <- c("027500", "025500", "024700", "024100", "023700", "023300", "022900", "022500", "022301", "021900","021100","020500", "019900", "019500",
"019100", "018700", "018300", "017900", "017500", "017100","016700", "016300", "015900", "015500", "015100", "013500", "012900", "011700", "009900", "007900", "007500", "006900", "003700",
"003900", "031703", "031704","031900", "000500", "000900","000700", "001502", "001501", "002500", "000800","000600","000201", "000202", "001001", "001002", "002000", "002400", "004400",
"006000", "006200", "008601", "008602", "023801", "010601","010602","011600", "012400", "013200", "013600", "023802", "015200","017800", "019200", "024200", "021000", "023600", "024302", "031100",
"029900", "029700", "028700", "022302", "016200", "024000")
index_river=c()
k=1
for (i in 1:dim(CBG_ny)[1]) {
if (CBG_ny$TractCode[i] %in% track_code_river) {
index_river[k] = i
k=k+1
}
}
# TROVIAMO I CBG DEI FIUMI
CBG_RIVER<-CBG_ny[index_river,]
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_RIVER$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
remove <- c("360610005001","360610005000",
"360610319001", "360610009001", "360610015020", "360610007001", "360610319001", "360610319000", "360610317040", "360610317044")
remove_index = c()
k=1
for (i in 1:dim(CBG_RIVER)[1]) {
if (CBG_RIVER$CensusBlockGroup %in% remove) {
index_river[k] = i
k=k+1
}
}
CBG_RIVER<-CBG_RIVER[-remove_index]
CBG_RIVER<-CBG_RIVER[-remove_index,]
remove <- c("360610005001","360610005000",
"360610319001", "360610009001", "360610015020", "360610007001", "360610319001", "360610319000", "360610317040", "360610317044")
remove_index = c()
k=1
for (i in 1:dim(CBG_RIVER)[1]) {
if (CBG_RIVER$CensusBlockGroup %in% remove) {
index_river[k] = i
k=k+1
}
}
remove_index = c()
k=1
for (i in 1:dim(CBG_RIVER)[1]) {
if (CBG_RIVER$CensusBlockGroup[i] %in% remove) {
index_river[k] = i
k=k+1
}
}
View(CBG_RIVER)
CBG_RIVER$CensusBlockGroup[1] %in% remove
which(CBG_RIVER$CensusBlockGroup=="360610005001")
CBG_RIVER$CensusBlockGroup[11] %in% remove
remove_index = c()
k=1
for (i in 1:dim(CBG_RIVER)[1]) {
if (CBG_RIVER$CensusBlockGroup[i] %in% remove) {
index_river[k] = i
k=k+1
}
}
remove_index = c()
k=1
for (i in 1:dim(CBG_RIVER)[1]) {
if (CBG_RIVER$CensusBlockGroup[i] %in% remove) {
print(i)
index_river[k] = i
k=k+1
}
}
remove_index = c()
k=1
for (i in 1:dim(CBG_RIVER)[1]) {
if (CBG_RIVER$CensusBlockGroup[i] %in% remove) {
remove_index[k] = i
k=k+1
}
}
CBG_RIVER<-CBG_RIVER[-remove_index,]
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_RIVER$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
remove <- c("360610005001",
"360610319001", "360610009001", "360610015020", "360610007001", "360610319001", "360610319000", "360610317040", "360610317044")
remove_index = c()
k=1
for (i in 1:dim(CBG_RIVER)[1]) {
if (CBG_RIVER$CensusBlockGroup[i] %in% remove) {
remove_index[k] = i
k=k+1
}
}
CBG_RIVER<-CBG_RIVER[-remove_index,]
track_code_river <- c("027500", "025500", "024700", "024100", "023700", "023300", "022900", "022500", "022301", "021900","021100","020500", "019900", "019500",
"019100", "018700", "018300", "017900", "017500", "017100","016700", "016300", "015900", "015500", "015100", "013500", "012900", "011700", "009900", "007900", "007500", "006900", "003700",
"003900", "031703", "031704","031900", "000500", "000900","000700", "001502", "001501", "002500", "000800","000600","000201", "000202", "001001", "001002", "002000", "002400", "004400",
"006000", "006200", "008601", "008602", "023801", "010601","010602","011600", "012400", "013200", "013600", "023802", "015200","017800", "019200", "024200", "021000", "023600", "024302", "031100",
"029900", "029700", "028700", "022302", "016200", "024000")
index_river=c()
k=1
for (i in 1:dim(CBG_ny)[1]) {
if (CBG_ny$TractCode[i] %in% track_code_river) {
index_river[k] = i
k=k+1
}
}
CBG_RIVER<-CBG_ny[index_river,]
remove <- c("360610005001",
"360610319001", "360610009001", "360610015020", "360610007001", "360610319001", "360610319000", "360610317040", "360610317044")
remove_index = c()
k=1
for (i in 1:dim(CBG_RIVER)[1]) {
if (CBG_RIVER$CensusBlockGroup[i] %in% remove) {
remove_index[k] = i
k=k+1
}
}
CBG_RIVER<-CBG_RIVER[-remove_index,]
# TROVIAMO I CBG DEI FIUMI
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_RIVER$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
track_code_river <- c("027500", "025500", "024700", "024100", "023700", "023300", "022900", "022500", "022301", "021900","021100","020500", "019900", "019500",
"019100", "018700", "018300", "017900", "017500", "017100","016700", "016300", "015900", "015500", "015100", "013500", "012900", "011700", "009900", "007900", "007500", "006900", "003700",
"003900", "031703", "031704","031900", "000500", "000900","000700", "001502", "001501", "002500", "000800","000600","000201", "000202", "001001", "001002", "002000", "002400", "004400",
"006000", "006200", "008601", "008602", "023801", "010601","010602","011600", "012400", "013200", "013600", "023802", "015200","017800", "019200", "024200", "021000", "023600", "024302", "031100",
"029900", "029700", "028700", "022302", "016200", "024000")
index_river=c()
k=1
for (i in 1:dim(CBG_ny)[1]) {
if (CBG_ny$TractCode[i] %in% track_code_river) {
index_river[k] = i
k=k+1
}
}
CBG_RIVER<-CBG_ny[index_river,]
remove <- c("360610005001")
remove_index = c()
k=1
for (i in 1:dim(CBG_RIVER)[1]) {
if (CBG_RIVER$CensusBlockGroup[i] %in% remove) {
remove_index[k] = i
k=k+1
}
}
CBG_RIVER<-CBG_RIVER[-remove_index,]
# TROVIAMO I CBG DEI FIUMI
x11()
plot(st_geometry(CBG_ny$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ")
par(new=T)
plot(st_geometry(CBG_RIVER$geometry), xlim = c(-74.1,-73.8), ylim = c(40.68,40.88), xlab = " ", ylab = " ",col = "red")
